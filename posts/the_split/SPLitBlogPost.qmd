---
title: "The SPLit"
author: "Jess Hargreaves"
format: html
editor: visual
description: "The Scottish Premier League splits into two for a playoff structure.  Does this have unintended consequences?"
date: "3/12/2025"
bibliography: references.bib
categories:
  - Football
  - SPL
---

```{r}
#| label: load-packages
#| include: false

# library
library(ggplot2)
library(plotly)
library(ggiraph)
library(tidyverse)
library(readxl)
library(highcharter) 
# Set highcharter options
options(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))

```

```{r}
#| label: load-data
#| include: false

Data2324 <- read_excel("app1/Data2324.xlsx")

```

## Introduction

The Scottish Football League (SFL) is a professional football competition similar to other open European football leagues, featuring multiple divisions with promotion and relegation. The Scottish Premier League (SPL) is the top division. In the 2000/01 season, the SPL expanded from 10 to 12 teams [@lenten2008unbalanced]. The addition of these teams had the potential to create fixture congestion as, traditionally, SPL teams played each other four times in a round-robin format, twice at home and twice away, with 36 fixtures played in total. With the new format, teams would have to complete 44 games.

To avoid fixture congestion and to make the total number of fixtures comparable to other top leagues in Europe, the SPL altered its tournament design. It "split" the season into two: the "Regular Season" and the "Play-offs". During the Regular Season, teams play one another three times for a total of 33 matches. Then the league is "split" in two, creating two mini-leagues. Teams who finish in the **top six** places after 33 games play one another (one more time) in the "**Championship Play-off**" and the **bottom six** teams play one another in the "**Relegation Play-off**". This leads to a total of 38 games being played by each team, the same number of matches as other European leagues [@reilly2024effect].

The points accumulated prior to The Split are added to the points accrued after The Split. However, teams are bounded within their section of The Split. Therefore, after 33 games, if a team finishes in the top six, they cannot finish lower than sixth at the end of the season. Similarly, a team finishing in the bottom six after 33 games cannot finish higher than seventh after 38 games. As an example, the final 2023/24 SPL Table is displayed in @tbl-table1, showing that ninth-placed Motherwell accrued more points than sixth-placed Dundee.

| **Position** | **Team**            | **Points** |
|:------------:|:--------------------|:----------:|
|      1       | Celtic              |     93     |
|      2       | Rangers             |     85     |
|      3       | Heart of Midlothian |     68     |
|      4       | Kilmarnock          |     56     |
|      5       | St. Mirren          |     47     |
|      6       | Dundee              |     42     |
|      7       | Aberdeen            |     48     |
|      8       | Hibernian           |     46     |
|      9       | Motherwell          |     43     |
|      10      | St. Johnstone       |     35     |
|      11      | Ross County         |     35     |
|      12      | Livingston          |     25     |

: The completed Scottish Premier League Table for the 2023/24 season. Recall: the top six teams (after 33 games) qualify for the "Championship Play-off" and the bottom six teams compete in the "Relegation Play-off". {#tbl-table1 .striped}

In this blog post, we perform an exploratory data analysis to investigate the impact of the SPL Split Policy on matchday attendance. We also introduce an open-access Shiny Application that provides interactive visualisations of attendance data in the SPL.

## Exploratory Data Analysis

In this section, we investigate the pattern of home attendance in the SPL (2023/24 season) using data from the [football reference website](https://fbref.com/ "FBRef.com").

@fig-attendanceprop shows home attendances as a proportion of stadium capacity for all 12 teams in the 2023/24 SPL season. Celtic, Rangers, and, to a lesser extent, Hearts, display stable attendance, nearly selling out all matches. In contrast, the other teams show fluctuating attendances.

```{r}
#| echo: false
#| label: fig-attendanceprop
#| warning: false
#| fig-cap: "Attendances as a proportion of stadium capacity for all teams in the 2023/24 SPL Season. Solid lines indicate teams in the Championship Play-off. Dashed lines indicate teams in the Relegation Play-off."

team.colours2 <- c("Aberdeen" = "red", "Celtic"= "green", "Dundee" = "black", "Hearts" = "purple", "Hibernian" = "deeppink", "Kilmarnock" = "grey", "Livingston" = "violet", "Motherwell" = "orange", "Rangers" = "blue", "Ross County" ="deepskyblue", "St Johnstone" = "yellow", "St Mirren" ="cyan")
custom_dashes <- c("Aberdeen" = "Dash", "Celtic"= "Solid", "Dundee" = "Solid", "Hearts" = "Solid", "Hibernian" = "Dash", "Kilmarnock" = "Solid", "Livingston" = "Dash", "Motherwell" = "Dash", "Rangers" = "Solid", "Ross County" ="Dash", "St Johnstone" = "Dash", "St Mirren" ="Solid")

teams <- unique(Data2324$Home)

hc <- hchart(  Data2324, "line",   hcaes(x = MWk, y = Aprop, group = Home),  color = team.colours2, dashStyle=custom_dashes ) |>
hc_title(text = "Attendance as a Proportion of Stadium Capacity") |>
  hc_xAxis(title = list(text = "Match Week"), plotBands = list(list(color="lightgrey", from=34, to=39))) |>
  hc_yAxis(title = list(text = "Proportion"), max=1) |>
  hc_tooltip(crosshairs=TRUE, formatter = JS("function(){
                            return ('Team: ' + this.point.Home + '<br> Opponent: ' + this.point.Away + ' <br> Attendance: ' + this.point.Attendance + ' <br> Match Week: ' + this.point.MWk + '<br> Round: ' + this.point.Round)
                            }"))
hc
```

To investigate this further, home attendances for four SPL teams in 2023/24 (Celtic, Rangers, Dundee, and Aberdeen), each with different stadium capacities (60,500, 51,082, 11,850, and 21,412) are plotted in @fig-homeattendance.

```{r}
#| echo: false

#### A function to create an interactive attendance plot

#############################

IAPlot <- function(team, Data){
 team.colours2 <- c("Aberdeen" = "red", "Celtic"= "green", "Dundee" = "black", "Hearts" = "purple", "Hibernian" = "deeppink", "Kilmarnock" = "grey", "Livingston" = "violet", "Motherwell" = "orange", "Rangers" = "blue", "Ross County" ="deepskyblue", "St Johnstone" = "yellow", "St Mirren" ="cyan")
  
# Create team subset  
teamdata <- subset(Data, Home==team)
n <- dim(teamdata)[1]
ymin <- min(teamdata$Attendance)
ymax <- max(max(teamdata$Attendance), teamdata$Capacity[1])

##### Plot
p <- ggplot(teamdata ,
            aes(x=MWk, y=Attendance )) +
  geom_line(data=teamdata,aes(x=MWk,y=Attendance)) +
  geom_rect(xmin = 33.5, xmax = 40, ymin = ymin, ymax = ymax, alpha = .1, fill = "blue")+
  geom_point(color='black', shape=21, size=2, aes(fill=factor(Away), text=paste("<b>Match Week:</b>",MWk,"<br><b>Date:</b>",Date, "<br><b>Attendance:</b>",Attendance, "<br><b>Opponent:</b>", Away))) + 
  xlab("Match Week") +
  xlim(1, 40) + ylim(ymin, ymax)+
  geom_hline(yintercept=teamdata$Capacity[1], linetype="dashed", color = "blue")+ 
  #geom_vline(xintercept=33.5, color = "red") +
  labs(fill='Opponent')+
  scale_fill_manual(values=team.colours2) +
  theme(legend.position = "none")+theme_light()


#X11()
interactive_plot <- ggplotly(p, tooltip = "text")
interactive_plot$x$data[[2]]$hoverinfo <- "none"
return(interactive_plot)
#ggplot(data=celtic,aes(x=MWk,y=Attendance))  +geom_line()+geom_point()
}

```

```{r}
#| echo: false
#| label: fig-homeattendance
#| layout-ncol: 2
#| layout-nrow: 2
#| warning: false
#| fig-cap: "Home attendances for four example SPL Teams in the 2023/24 Season. The reported stadium capacity is shown as a horizontal dashed blue line. Blue background denotes play-off matches."
#| fig-subcap: 
#| - "Celtic (Championship Play-off)."
#| - "Rangers (Championship Play-off)."
#| - "Dundee (Championship Play-off)."
#| - "Aberdeen (Relegation Play-off)."

IAPlot("Celtic", Data2324)
IAPlot("Rangers", Data2324)
IAPlot("Dundee", Data2324)
IAPlot("Aberdeen", Data2324)
```

It appears that attendance fluctuations are driven by the opposition, with higher attendances when the "Old Firm" teams (or a historic rival) visit. In particular, matched attendances against the same opposition (Pre- and Post-Split) are very similar. Furthermore, note that the three Post-Split fixtures for Aberdeen (who finished seventh Pre-Split, just missing out on the Championship Play-off) are against two of the opponents that drew the lowest attendances Pre-Split.

## Shiny Application

We have also developed an open-access Shiny Application ([SPLit](https://shiny.york.ac.uk/SPLit/ "shiny.york.ac.uk/SPLit")) to complement this blog post. This app plots alternative versions of @fig-attendanceprop and @fig-homeattendance for other teams and seasons. The user selects one of three example SPL seasons from the dataset and an SPL team, and the app creates two (interactive) plots: Attendance as a Proportion of Stadium Capacity for all teams (top panel) and Home Match Attendance for the selected team (bottom panel). These interactive plots mirror @fig-attendanceprop and @fig-homeattendance , allowing users to explore **other** seasons or teams to verify our conclusions. The app also provides additional information (such as raw attendance numbers for every match).

## Conclusions

In this blog post, we have investigated the impact of the policy to split the Scottish Premier League (SPL) into two after 33 games for post-season play. In particular, whether this format reduced attendance for teams finishing in the lower half of the standings. Our analysis suggests that teams finishing in the Relegation Play-off may face an attendance drop compared to teams just qualifying for the Championship Play-off. @fig-attendanceprop and @fig-homeattendance suggest that the opposition, particularly the two superstar clubs Rangers and Celtic, drive these attendance differences.

## Further Developments

This analysis has motivated the hypotheses which we investigate in detail in the upcoming paper "The Split: Analysing Contest Design in the Scottish Premier League." Using a regression discontinuity (RD) design approach [@thistlethwaite1960regression] , we will test if The Split dis-incentivised winning and disadvantaged teams in the lower half of the standings. Using data from 2000/01 to 2023/24, we will **empirically** test whether:

1.  performing with suboptimal effort ("tanking") occurred for mid-table clubs;

2.  the "split" impacted teams above the cut-off more than those below in terms of (home) attendance;

3.  any home attendance differences may be explained via "superstar" effects.

## References

::: {#refs}
:::
